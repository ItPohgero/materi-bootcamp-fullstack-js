# 2. Setup TypeScript dengan Bun

## Install Bun

Pastikan Bun sudah terinstall.

```bash
# Check version
bun --version

# Jika belum install
curl -fsSL https://bun.sh/install | bash
```

---

## Initialize TypeScript Project

### Bun Init

```bash
# Create project directory
mkdir my-typescript-project
cd my-typescript-project

# Initialize project
bun init

# Bun akan tanya:
# - Package name
# - Entry point (default: index.ts)

# Atau skip questions
bun init -y
```

Ini akan generate:
- `package.json`
- `tsconfig.json`
- `index.ts`
- `README.md`
- `.gitignore`

---

## Project Structure

```
my-typescript-project/
├── src/
│   ├── index.ts
│   ├── types/
│   │   └── user.ts
│   ├── utils/
│   │   └── helpers.ts
│   └── services/
│       └── userService.ts
├── tests/
│   └── index.test.ts
├── package.json
├── tsconfig.json
├── .env
└── README.md
```

---

## tsconfig.json

Configuration file untuk TypeScript compiler.

### Basic Configuration (Generated by Bun)

```json
{
  "compilerOptions": {
    "lib": ["ESNext"],
    "module": "esnext",
    "target": "esnext",
    "moduleResolution": "bundler",
    "moduleDetection": "force",
    "allowImportingTsExtensions": true,
    "noEmit": true,
    "composite": true,
    "strict": true,
    "downlevelIteration": true,
    "skipLibCheck": true,
    "jsx": "react-jsx",
    "allowSyntheticDefaultImports": true,
    "forceConsistentCasingInFileNames": true,
    "allowJs": true,
    "types": [
      "bun-types"
    ]
  }
}
```

### Recommended Settings

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "lib": ["ES2020"],
    "moduleResolution": "bundler",
    
    // Strict Type Checking
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    
    // Additional Checks
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    
    // Module Resolution
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "forceConsistentCasingInFileNames": true,
    
    // Bun specific
    "types": ["bun-types"],
    "noEmit": true,
    
    // Paths
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    }
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
```

---

## Package.json Setup

```json
{
  "name": "my-typescript-project",
  "version": "1.0.0",
  "module": "src/index.ts",
  "type": "module",
  "scripts": {
    "start": "bun run src/index.ts",
    "dev": "bun --watch src/index.ts",
    "test": "bun test",
    "typecheck": "tsc --noEmit"
  },
  "devDependencies": {
    "@types/bun": "latest",
    "bun-types": "latest"
  },
  "dependencies": {}
}
```

---

## First TypeScript File

### Basic Example

```typescript
// src/index.ts
console.log("Hello from TypeScript!");

const greeting: string = "Welcome to TypeScript";
const count: number = 42;
const isActive: boolean = true;

console.log(greeting);
console.log(`Count: ${count}`);
console.log(`Active: ${isActive}`);

// Run: bun src/index.ts
```

### With Function

```typescript
// src/index.ts
function greet(name: string): string {
    return `Hello, ${name}!`;
}

function add(a: number, b: number): number {
    return a + b;
}

console.log(greet("TypeScript"));
console.log(`Sum: ${add(5, 3)}`);

// Run: bun src/index.ts
```

---

## Running TypeScript dengan Bun

### Direct Run (No Compilation!)

```bash
# Run TypeScript file directly
bun index.ts

# Run dengan watch mode
bun --watch index.ts

# Run specific script
bun run start
bun run dev
```

### Advantages dengan Bun

- No compilation step
- Instant execution
- Native TypeScript support
- Fast startup time
- Hot reload dengan --watch

---

## Install Type Definitions

### Bun Types

```bash
# Install Bun types
bun add -d bun-types

# Atau
bun add --dev @types/bun
```

### Common Type Packages

```bash
# Node.js types (jika pakai Node APIs)
bun add -d @types/node

# Express types
bun add -d @types/express

# React types
bun add -d @types/react
```

---

## VSCode Setup untuk TypeScript

### Extensions

1. **TypeScript and JavaScript Language Features** (Built-in)
2. **ESLint**
3. **Prettier**
4. **Error Lens** (Show errors inline)

### VSCode Settings

```json
{
  "typescript.tsdk": "node_modules/typescript/lib",
  "typescript.enablePromptUseWorkspaceTsdk": true,
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  }
}
```

### Keyboard Shortcuts

| Shortcut | Fungsi |
|----------|--------|
| `F12` | Go to definition |
| `Shift + F12` | Find all references |
| `F2` | Rename symbol |
| `Ctrl + Space` | Trigger IntelliSense |
| `Ctrl + .` | Quick fix |

---

## Type Checking

### Check Types tanpa Run

```bash
# TypeScript type checker
tsc --noEmit

# Atau add ke package.json
# "typecheck": "tsc --noEmit"
bun run typecheck
```

### Watch Mode

```bash
tsc --noEmit --watch
```

---

## ESLint untuk TypeScript

### Install ESLint

```bash
bun add -d eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin
```

### .eslintrc.json

```json
{
  "parser": "@typescript-eslint/parser",
  "parserOptions": {
    "ecmaVersion": 2020,
    "sourceType": "module"
  },
  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended"
  ],
  "rules": {
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/no-explicit-any": "warn"
  }
}
```

---

## Prettier untuk TypeScript

### Install Prettier

```bash
bun add -d prettier
```

### .prettierrc

```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 80,
  "arrowParens": "avoid"
}
```

---

## Example Project Setup

### Complete Setup

```bash
# 1. Create directory
mkdir my-ts-api
cd my-ts-api

# 2. Initialize
bun init -y

# 3. Install dependencies
bun add express
bun add -d @types/express bun-types

# 4. Create structure
mkdir -p src/routes src/controllers src/types
```

### src/index.ts

```typescript
console.log("TypeScript API Server");
console.log("Bun version:", Bun.version);

const PORT = process.env.PORT || 3000;

Bun.serve({
    port: PORT,
    fetch(req) {
        return new Response("TypeScript API with Bun");
    },
});

console.log(`Server running on http://localhost:${PORT}`);
```

### Run

```bash
bun --watch src/index.ts
```

---

## Troubleshooting

### Problem: "Cannot find module"

**Solution:**
1. Check import path
2. Check file exists
3. Add to tsconfig paths if needed

```json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    }
  }
}
```

### Problem: Type errors tapi code jalan

**Solution:**
- Install missing type definitions
- Check tsconfig.json strict settings

```bash
bun add -d @types/package-name
```

### Problem: "Cannot use import statement"

**Solution:**
Pastikan `"type": "module"` di package.json

```json
{
  "type": "module"
}
```

---

## Best Practices

### DO (Lakukan)

1. **Enable strict mode**
   ```json
   {
     "compilerOptions": {
       "strict": true
     }
   }
   ```

2. **Organize files by feature**
   ```
   src/
   ├── users/
   │   ├── user.types.ts
   │   ├── user.service.ts
   │   └── user.controller.ts
   └── products/
       ├── product.types.ts
       └── product.service.ts
   ```

3. **Use path aliases**
   ```typescript
   import { User } from '@/types/user';
   ```

4. **Type check before commit**
   ```bash
   bun run typecheck
   ```

### DON'T (Jangan)

1. Jangan commit dengan type errors
2. Jangan disable strict tanpa alasan
3. Jangan gunakan 'any' everywhere
4. Jangan skip type definitions untuk libraries

---

## Rangkuman

- Bun support TypeScript native (no compilation!)
- Run .ts files directly: `bun file.ts`
- Initialize dengan `bun init`
- tsconfig.json untuk configuration
- Enable strict mode untuk maximum type safety
- Install @types packages untuk libraries
- Use ESLint dan Prettier untuk code quality
- VSCode has excellent TypeScript support
- Type checking dengan `tsc --noEmit`
- Bun makes TypeScript development blazing fast

---

**Sebelumnya:** [01. Pengenalan TypeScript](01-pengenalan-typescript.md)  
**Selanjutnya:** [03. Basic Types](03-basic-types.md)

